<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monthly Salaries - Accounting System</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        :root {
            --color-primary: #00A693;
            --color-background: #F2F3F4;
            --color-accent: #E08A27;
            --color-text-dark: #1A1A1A;
            --color-text-light: #FFFFFF;
        }

        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Noto+Sans+Devanagari:wght@400;700&family=Noto+Nastaliq+Urdu:wght@400;700&display=swap');

        /* Language Styles */
        body,
        .lang-en {
            font-family: 'Poppins', sans-serif;
            direction: ltr;
            background-color: var(--color-background);
        }

        .lang-hi {
            font-family: 'Noto Sans Devanagari', sans-serif;
            direction: ltr;
        }

        .lang-ur {
            font-family: 'Noto Nastaliq Urdu', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
            direction: rtl;
            line-height: 1.8;
            text-align: right;
        }

        /* Form & Inputs */
        .form-input,
        select {
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            border: 1px solid #ccc;
            width: 100%;
            font-family: inherit;
        }

        .form-input:focus,
        select:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(0, 166, 147, 0.2);
        }

        .form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.25rem;
            font-size: 0.875rem;
        }

        /* Buttons */
        .primary-button {
            padding: 0.8rem 1.5rem;
            background-color: var(--color-primary);
            color: var(--color-text-light);
            font-weight: 600;
            border-radius: 0.75rem;
            transition: background-color 0.3s, transform 0.1s;
            cursor: pointer;
        }

        .primary-button:hover {
            background-color: #008f7d;
            transform: translateY(-1px);
        }

        .action-button {
            padding: 0.5rem 0.75rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 600;
            transition: background-color 0.2s;
        }

        /* Fixed Header */
        header {
            background-color: var(--color-text-light);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            position: sticky;
            top: 0;
            width: 100%;
            z-index: 10;
            padding: 1rem 2rem;
        }

        /* Table Styling */
        .admin-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0 10px;
        }

        .admin-table th {
            text-align: left;
            padding: 0.75rem 1rem;
            font-size: 0.8rem;
            color: gray;
            text-transform: uppercase;
            font-weight: 700;
        }

        .lang-ur .admin-table th {
            text-align: right;
        }

        .admin-table td {
            padding: 0.75rem 1rem;
            background-color: white;
            border-top: 1px solid #eee;
            border-bottom: 1px solid #eee;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .admin-table tr td:first-child {
            border-top-left-radius: 0.75rem;
            border-bottom-left-radius: 0.75rem;
        }

        .admin-table tr td:last-child {
            border-top-right-radius: 0.75rem;
            border-bottom-right-radius: 0.75rem;
        }

        .table-container {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .table-container table {
            min-width: 1000px;
        }

        /* Payroll Status */
        .status-pill {
            display: inline-block;
            padding: 0.3rem 0.7rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .status-pending {
            background-color: #f59e0b;
            color: white;
        }

        .status-paid {
            background-color: #10b981;
            color: white;
        }

        /* Modal Styles */
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.6);
            transition: opacity 0.3s ease;
        }

        .modal-content {
            background-color: var(--color-background);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            border-radius: 1rem;
            max-width: 95%;
            width: 700px;
            max-height: 90vh;
            overflow-y: auto;
            border: 3px solid var(--color-primary);
        }
    </style>
</head>

<body class="lang-en">

    <script>
        // Helper to format date YYYY-MM
        function formatMonthYear(date) {
            const d = new Date(date);
            let month = '' + (d.getMonth() + 1);
            const year = d.getFullYear();
            if (month.length < 2) month = '0' + month;
            return [year, month].join('-');
        }

        // --- Dummy Staff Data (Simulating Admin/Staff Management) ---
        const DUMMY_STAFF = [
            { id: 'E001', name: 'Maulana Ahmed', designation: 'Head Teacher', baseSalary: 45000.00, monthlyBasis: true },
            { id: 'E002', name: 'Zainab Begum', designation: 'Accountant', baseSalary: 30000.00, monthlyBasis: true },
            { id: 'E003', name: 'Hafiz Omar', designation: 'Teacher', baseSalary: 25000.00, monthlyBasis: true },
            { id: 'E004', name: 'Qasim Ali', designation: 'Kitchen Staff', baseSalary: 15000.00, monthlyBasis: false, dailyRate: 500 }, // Daily Basis Example
        ];

        // --- Dummy Payroll Data ---
        const PAYROLL_STORAGE_KEY = 'madarsaMonthlyPayroll';
        let payrollRecords = {}; // Key: YYYY-MM, Value: [{staffId, status, netSalary, details}]

        // --- Payroll Constants ---
        const BASE_DEDUCTION_PERCENT = 0.05; // 5% PF/Tax deduction
        const BONUS = 5000.00; // Example bonus for simplicity

        // Load/Save Logic
        function loadPayroll() {
            const storedRecords = localStorage.getItem(PAYROLL_STORAGE_KEY);
            if (storedRecords) {
                try {
                    payrollRecords = JSON.parse(storedRecords);
                } catch (e) {
                    console.error("Error loading payroll records:", e);
                }
            }
        }

        function savePayroll() {
            localStorage.setItem(PAYROLL_STORAGE_KEY, JSON.stringify(payrollRecords));
        }

        // --- Multilingual Data ---
        const langData = {
            'en': {
                'accounting_system': 'Accounting System',
                'page_title': 'Monthly Salaries (Payroll)',
                'back_to_accounting': 'Back to Accounting',
                'logout': 'Logout',

                // Filters/Actions
                'select_month': 'Select Month',
                'process_selected': 'Process Selected',
                'month': 'Month',
                'year': 'Year',
                'payroll_status': 'Payroll Status',
                'pending': 'Pending',
                'paid': 'Paid',
                'search_staff': 'Search Staff Name/ID...',

                // Table Headers
                'employee_id': 'ID',
                'employee_name': 'Name',
                'designation': 'Designation',
                'salary_basis': 'Basis',
                'gross_salary': 'Gross Salary',
                'deductions': 'Deductions',
                'net_payable': 'Net Payable',
                'status': 'Status',
                'actions': 'Actions',
                'view_calc': 'View/Edit Calculation',

                // Modal/Details
                'modal_title': 'Salary Calculation Details',
                'basic_pay': 'Basic Pay',
                'allowances': 'Allowances/Bonus',
                'total_deductions': 'Total Deductions',
                'final_net': 'Final Net Payable',
                'notes': 'Adjustment/Notes',
                'save_adjustment': 'Save Adjustment',
                'day_count': 'Work Days (30)',
                'month_days': 'Total Days in Month (30)'
            },
            'hi': {
                'accounting_system': 'लेखांकन प्रणाली',
                'page_title': 'मासिक वेतन (पेरोल)',
                'back_to_accounting': 'लेखांकन पर वापस',
                'logout': 'लॉगआउट',

                // Filters/Actions
                'select_month': 'महीना चुनें',
                'process_selected': 'चयनित को प्रोसेस करें',
                'month': 'महीना',
                'year': 'वर्ष',
                'payroll_status': 'पेरोल स्थिति',
                'pending': 'विचाराधीन',
                'paid': 'भुगतान किया गया',
                'search_staff': 'स्टाफ का नाम/आईडी खोजें...',

                // Table Headers
                'employee_id': 'आईडी',
                'employee_name': 'नाम',
                'designation': 'पदनाम',
                'salary_basis': 'आधार',
                'gross_salary': 'सकल वेतन',
                'deductions': 'कटौतियाँ',
                'net_payable': 'शुद्ध देय',
                'status': 'स्थिति',
                'actions': 'कार्यवाही',
                'view_calc': 'गणना देखें/संपादित करें',

                // Modal/Details
                'modal_title': 'वेतन गणना विवरण',
                'basic_pay': 'मूल वेतन',
                'allowances': 'भत्ते/बोनस',
                'total_deductions': 'कुल कटौतियाँ',
                'final_net': 'अंतिम शुद्ध देय',
                'notes': 'समायोजन/नोट्स',
                'save_adjustment': 'समायोजन सहेजें',
                'day_count': 'कार्य दिवस (30)',
                'month_days': 'महीने के कुल दिन (30)'
            },
            'ur': {
                'accounting_system': 'اکاؤنٹنگ نظام',
                'page_title': 'ماہانہ تنخواہیں (پے رول)',
                'back_to_accounting': 'اکاؤنٹنگ پر واپس جائیں',
                'logout': 'لاگ آؤٹ',

                // Filters/Actions
                'select_month': 'مہینہ منتخب کریں',
                'process_selected': 'منتخب کو پروسیس کریں',
                'month': 'مہینہ',
                'year': 'سال',
                'payroll_status': 'پے رول کی حیثیت',
                'pending': 'زیر التوا',
                'paid': 'ادا کر دیا گیا',
                'search_staff': 'عملے کا نام/آئی ڈی تلاش کریں...',

                // Table Headers
                'employee_id': 'آئی ڈی',
                'employee_name': 'نام',
                'designation': 'عہدہ',
                'salary_basis': 'بنیاد',
                'gross_salary': 'مجموعی تنخواہ',
                'deductions': 'کٹوتیوں',
                'net_payable': 'خالص قابل ادائیگی',
                'status': 'حالت',
                'actions': 'عمل',
                'view_calc': 'حساب دیکھیں/ترمیم کریں',

                // Modal/Details
                'modal_title': 'تنخواہ کے حساب کی تفصیلات',
                'basic_pay': 'بنیادی تنخواہ',
                'allowances': 'الاؤنسز/بونس',
                'total_deductions': 'کل کٹوتیوں',
                'final_net': 'حتمی خالص قابل ادائیگی',
                'notes': 'ایڈجسٹمنٹ/نوٹس',
                'save_adjustment': 'ایڈجسٹمنٹ محفوظ کریں',
                'day_count': 'کام کے دن (30)',
                'month_days': 'مہینے کے کل دن (30)'
            }
        };

        let currentLang = 'en';

        function getTranslation(key) {
            return langData[currentLang][key] || langData['en'][key] || key;
        }

        // --- Core UI Update Functions ---
        function updateContent() {
            document.body.className = 'lang-' + currentLang;

            document.querySelectorAll('[data-lang-key]').forEach(el => {
                const key = el.getAttribute('data-lang-key');
                el.textContent = getTranslation(key);
            });

            loadPayroll(); // Ensure latest records are loaded
            renderStaffTable();
        }

        function changeLanguage(lang) {
            if (lang in langData) {
                currentLang = lang;
                localStorage.setItem('madarsaSystemLang', lang);
                updateContent();
            }
        }

        // --- Calculation Logic ---
        function calculateSalary(staff, monthYear) {
            // Check if record already exists
            const existingRecord = payrollRecords[monthYear]?.find(r => r.staffId === staff.id);
            if (existingRecord) {
                return existingRecord;
            }

            let basic = staff.baseSalary;
            let deduction = basic * BASE_DEDUCTION_PERCENT;
            let net = basic + BONUS - deduction;

            return {
                staffId: staff.id,
                monthYear: monthYear,
                status: 'Pending',
                grossSalary: basic,
                deductionAmount: deduction,
                bonusAmount: BONUS,
                netSalary: net,
                adjustedAmount: 0.00,
                adjustmentNotes: ''
            };
        }

        // --- Table Rendering ---
        function renderStaffTable() {
            const tbody = document.getElementById('staff-table-body');
            const monthYear = document.getElementById('month-year-select').value;
            const statusFilter = document.getElementById('status-filter').value;
            const searchInput = document.getElementById('search-input').value.toLowerCase();

            if (!tbody || !monthYear) return;

            tbody.innerHTML = '';

            DUMMY_STAFF.forEach(staff => {
                const record = calculateSalary(staff, monthYear);

                // Filtering
                const matchesSearch = staff.name.toLowerCase().includes(searchInput) || staff.id.toLowerCase().includes(searchInput);
                const matchesStatus = !statusFilter || record.status === statusFilter;

                if (!matchesSearch || !matchesStatus) return;

                // Status Pill
                const statusKey = record.status.toLowerCase();
                const statusClass = statusKey === 'paid' ? 'status-paid' : 'status-pending';
                const statusText = getTranslation(statusKey);

                // Display Values
                const netPayable = (record.netSalary + record.adjustedAmount).toFixed(2);
                const salaryBasis = staff.monthlyBasis ? 'Monthly' : 'Daily';

                const tr = document.createElement('tr');
                tr.dataset.staffId = staff.id;
                tr.dataset.monthYear = monthYear;
                tr.innerHTML = `
                    <td><input type="checkbox" name="select-staff" value="${staff.id}" ${record.status === 'Paid' ? 'disabled' : ''}></td>
                    <td>${staff.id}</td>
                    <td class="font-bold text-gray-800">${staff.name}</td>
                    <td>${staff.designation}</td>
                    <td>${salaryBasis}</td>
                    <td>${record.grossSalary.toFixed(2)}</td>
                    <td>${(record.deductionAmount - record.adjustedAmount).toFixed(2)}</td>
                    <td class="font-bold text-green-700">${netPayable}</td>
                    <td><span class="status-pill ${statusClass}">${statusText}</span></td>
                    <td>
                        <button onclick="handleAction('view', '${staff.id}', '${monthYear}')" class="action-button bg-blue-100 text-blue-700 hover:bg-blue-200">${getTranslation('view_calc')}</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });

            // Toggle bulk process button based on pending count
            const pendingCount = document.getElementById('staff-table-body').querySelectorAll('input[name="select-staff"]:not(:checked)').length;
            document.getElementById('bulk-process-btn').disabled = pendingCount === 0;
        }

        // --- Form/Modal Logic ---
        function handleAction(action, staffId, monthYear) {
            const staff = DUMMY_STAFF.find(s => s.id === staffId);
            const record = calculateSalary(staff, monthYear); // Get current state

            if (action === 'view') {
                openSalaryModal(staff, record, monthYear);
            }
        }

        function openSalaryModal(staff, record, monthYear) {
            const modal = document.getElementById('salary-modal');
            const isRtl = currentLang === 'ur';

            document.getElementById('modal-title').textContent = getTranslation('modal_title');

            // Calculate final values (Net Payable includes adjustments)
            const finalNet = (record.netSalary + record.adjustedAmount).toFixed(2);

            const formHtml = `
                <div class="space-y-4">
                    <h4 class="font-bold text-lg">${staff.name} (${staff.designation})</h4>
                    <p class="text-sm text-gray-500">${getTranslation('month')}: ${monthYear} | ${getTranslation('status')}: <span class="${record.status === 'Paid' ? 'text-green-600' : 'text-red-600'}">${getTranslation(record.status.toLowerCase())}</span></p>

                    <div class="grid grid-cols-2 gap-4 pt-4 border-t">
                        <!-- Left Column -->
                        <div>
                            <p class="form-label">${getTranslation('basic_pay')}</p>
                            <p class="text-lg font-semibold">${staff.baseSalary.toFixed(2)} ${getTranslation('INR')}</p>
                        </div>
                        <div>
                            <p class="form-label">${getTranslation('allowances')}</p>
                            <p class="text-lg font-semibold">${record.bonusAmount.toFixed(2)} ${getTranslation('INR')}</p>
                        </div>
                        <div>
                            <p class="form-label">${getTranslation('total_deductions')}</p>
                            <p class="text-lg font-semibold text-red-600">${record.deductionAmount.toFixed(2)} ${getTranslation('INR')}</p>
                        </div>
                        <div>
                            <p class="form-label">${getTranslation('final_net')}</p>
                            <p class="text-2xl font-bold text-green-700">${finalNet} ${getTranslation('INR')}</p>
                        </div>
                    </div>

                    <form id="adjustment-form" onsubmit="return handleAdjustment(event, '${staff.id}', '${monthYear}', ${record.netSalary})">
                        <div class="pt-4 border-t mt-4 space-y-4">
                            <h5 class="font-bold text-gray-700">${getTranslation('notes')} / ${getTranslation('save_adjustment')}</h5>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label for="adjustment-amount" class="form-label">Adjustment ( +/- )</label>
                                    <input type="number" id="adjustment-amount" class="form-input" value="${record.adjustedAmount.toFixed(2)}" step="0.01">
                                </div>
                                <div class="form-group">
                                    <label for="adjustment-notes" class="form-label">${getTranslation('notes')}</label>
                                    <textarea id="adjustment-notes" class="form-input h-10">${record.adjustmentNotes}</textarea>
                                </div>
                            </div>
                            
                            <div class="flex justify-end">
                                <button type="submit" class="action-button primary-button">${getTranslation('save_adjustment')}</button>
                            </div>
                        </div>
                    </form>
                </div>
            `;

            document.getElementById('modal-body').innerHTML = formHtml;
            modal.classList.remove('hidden', 'opacity-0');
        }

        function closeSalaryModal() {
            document.getElementById('salary-modal').classList.add('opacity-0');
            setTimeout(() => { document.getElementById('salary-modal').classList.add('hidden'); }, 300);
        }

        // --- Save Adjustment Logic ---
        function handleAdjustment(event, staffId, monthYear, netSalary) {
            event.preventDefault();
            const form = event.target;
            const adjustment = parseFloat(form.querySelector('#adjustment-amount').value) || 0;
            const notes = form.querySelector('#adjustment-notes').value.trim();

            if (!payrollRecords[monthYear]) {
                payrollRecords[monthYear] = [];
            }

            const staffIndex = DUMMY_STAFF.findIndex(s => s.id === staffId);
            const staff = DUMMY_STAFF[staffIndex];

            // Calculate the new record (if not exists, use base calculation)
            let newRecord = calculateSalary(staff, monthYear);
            const existingIndex = payrollRecords[monthYear].findIndex(r => r.staffId === staffId);

            if (existingIndex !== -1) {
                newRecord = payrollRecords[monthYear][existingIndex];
            }

            newRecord.adjustedAmount = adjustment;
            newRecord.adjustmentNotes = notes;

            // Save/Update the record in payrollRecords
            if (existingIndex !== -1) {
                payrollRecords[monthYear][existingIndex] = newRecord;
            } else {
                payrollRecords[monthYear].push(newRecord);
            }

            savePayroll();
            closeSalaryModal();
            updateContent();
            alert("Adjustment saved successfully!");
            return false;
        }

        // --- Bulk Process Logic ---
        function handleBulkProcess() {
            const monthYear = document.getElementById('month-year-select').value;
            const selectedStaffIds = Array.from(document.querySelectorAll('input[name="select-staff"]:checked'))
                .map(checkbox => checkbox.value);

            if (selectedStaffIds.length === 0) {
                alert("Please select staff members to process.");
                return;
            }

            if (confirm(`Confirm payment for ${selectedStaffIds.length} employees for ${monthYear}?`)) {
                if (!payrollRecords[monthYear]) {
                    payrollRecords[monthYear] = [];
                }

                selectedStaffIds.forEach(staffId => {
                    const staff = DUMMY_STAFF.find(s => s.id === staffId);
                    if (!staff) return;

                    let record = calculateSalary(staff, monthYear);
                    const existingIndex = payrollRecords[monthYear].findIndex(r => r.staffId === staffId);

                    if (existingIndex !== -1) {
                        record = payrollRecords[monthYear][existingIndex];
                    }

                    record.status = 'Paid';
                    record.paidDate = formatDate(new Date());

                    if (existingIndex !== -1) {
                        payrollRecords[monthYear][existingIndex] = record;
                    } else {
                        payrollRecords[monthYear].push(record);
                    }
                });

                savePayroll();
                updateContent();
                alert(`Successfully processed payment for ${selectedStaffIds.length} staff members.`);
            }
        }

        // --- Initialization ---
        window.onload = function () {
            loadPayroll(); // Load data
            const storedLang = localStorage.getItem('madarsaSystemLang');
            currentLang = (storedLang && storedLang in langData) ? storedLang : 'en';

            // Set default month to current month
            const today = new Date();
            const defaultMonth = formatMonthYear(today);
            document.getElementById('month-year-select').value = defaultMonth;

            // Initial content update and table render
            updateContent();

            // Attach listeners
            document.getElementById('month-year-select').addEventListener('change', updateContent);
            document.getElementById('status-filter').addEventListener('change', updateContent);
            document.getElementById('search-input').addEventListener('input', updateContent);
            document.getElementById('bulk-process-btn').addEventListener('click', handleBulkProcess);
        };
    </script>

    <!-- HEADER -->
    <header>
        <div class="max-w-7xl mx-auto w-full flex justify-between items-center">
            <!-- Left: Back Button & Title -->
            <div class="flex items-center space-x-4">
                <a href="accounting_system.html" class="action-button bg-gray-100 text-gray-700 hover:bg-gray-200"
                    data-lang-key="back_to_accounting">Back to Accounting</a>
                <h1 class="text-xl font-bold" data-lang-key="page_title" style="color: var(--color-primary);">Monthly
                    Salaries (Payroll)</h1>
            </div>

            <!-- Right: Language Switch -->
            <div class="flex items-center space-x-2">
                <select onchange="changeLanguage(this.value)" class="bg-gray-100 rounded-lg p-1 text-sm">
                    <option value="en" selected>English</option>
                    <option value="hi">हिन्दी</option>
                    <option value="ur">اردو</option>
                </select>
                <button onclick="window.location.href='login.html'"
                    class="text-sm font-semibold text-red-600 hover:text-red-800 transition-colors ml-4"
                    data-lang-key="logout">Logout</button>
            </div>
        </div>
    </header>

    <!-- MAIN CONTENT AREA -->
    <main class="max-w-7xl mx-auto w-full p-4 md:p-8">

        <!-- Filter and Actions -->
        <div class="bg-white p-6 md:p-8 rounded-xl shadow-2xl mb-8">
            <h2 class="text-2xl font-bold text-gray-700 mb-6" data-lang-key="page_title">Monthly Salaries (Payroll)</h2>

            <div class="grid grid-cols-1 md:grid-cols-6 gap-4 items-end">

                <!-- Month/Year Selector -->
                <div class="form-group md:col-span-2">
                    <label for="month-year-select" class="form-label" data-lang-key="select_month">Select Month</label>
                    <input type="month" id="month-year-select" class="form-input" required>
                </div>

                <!-- Status Filter -->
                <div class="form-group">
                    <label for="status-filter" class="form-label" data-lang-key="payroll_status">Payroll Status</label>
                    <select id="status-filter" class="form-input">
                        <option value="">All</option>
                        <option value="Pending" data-lang-key="pending">Pending</option>
                        <option value="Paid" data-lang-key="paid">Paid</option>
                    </select>
                </div>

                <!-- Search -->
                <div class="form-group">
                    <label for="search-input" class="form-label" data-lang-key="search_staff">Search Staff
                        Name/ID...</label>
                    <input type="text" id="search-input" class="form-input">
                </div>

                <!-- Bulk Process Button -->
                <div class="form-group md:col-span-2 flex justify-end">
                    <button type="button" id="bulk-process-btn" class="primary-button w-full md:w-auto">
                        <span data-lang-key="process_selected">Process Selected</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Payroll Staff Table -->
        <div class="bg-white p-6 md:p-8 rounded-xl shadow-2xl">
            <div class="table-container">
                <table class="admin-table">
                    <thead>
                        <tr class="bg-gray-100 rounded-lg">
                            <th><input type="checkbox" id="select-all-staff"></th>
                            <th data-lang-key="employee_id">ID</th>
                            <th data-lang-key="employee_name">Name</th>
                            <th data-lang-key="designation">Designation</th>
                            <th data-lang-key="salary_basis">Basis</th>
                            <th data-lang-key="gross_salary">Gross Salary</th>
                            <th data-lang-key="deductions">Deductions</th>
                            <th data-lang-key="net_payable">Net Payable</th>
                            <th data-lang-key="status">Status</th>
                            <th data-lang-key="actions">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="staff-table-body">
                        <!-- Staff data will be injected here by JS -->
                    </tbody>
                </table>
            </div>

            <div class="text-center text-sm text-gray-500 mt-6">
                <!-- Footer Info -->
            </div>
        </div>
    </main>

    <!-- SALARY CALCULATION MODAL -->
    <div id="salary-modal"
        class="hidden opacity-0 fixed inset-0 z-50 flex items-center justify-center modal-backdrop transition-opacity duration-300">
        <div class="modal-content p-6 md:p-8 transform scale-100 transition-transform duration-300">
            <div class="flex justify-between items-start pb-4 border-b mb-6">
                <h3 id="modal-title" class="text-xl font-bold text-gray-700">Salary Calculation Details</h3>
                <button onclick="closeSalaryModal()" class="text-gray-500 hover:text-gray-900 transition-colors p-1"
                    aria-label="Close">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                        stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div id="modal-body">
                <!-- Dynamic calculation and adjustment form goes here -->
            </div>
        </div>
    </div>
</body>

</html>