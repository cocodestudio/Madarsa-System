<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admission Old Students</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
      :root {
        --color-primary: #00a693;
        --color-background: #f2f3f4;
        --color-accent: #e08a27;
        --color-text-dark: #1a1a1a;
        --color-text-light: #ffffff;
      }

      @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Noto+Sans+Devanagari:wght@400;700&family=Noto+Nastaliq+Urdu:wght@400;700&display=swap");

      /* Language Styles */
      body,
      .lang-en {
        font-family: "Poppins", sans-serif;
        direction: ltr;
        background-color: var(--color-background);
      }

      .lang-hi {
        font-family: "Noto Sans Devanagari", sans-serif;
        direction: ltr;
      }

      .lang-ur {
        font-family: "Noto Nastaliq Urdu", "Segoe UI", Tahoma, Geneva, Verdana,
          sans-serif !important;
        direction: rtl;
        line-height: 1.8;
        text-align: right;
      }

      /* Form & Inputs */
      .form-input,
      select,
      .form-textarea {
        padding: 0.75rem 1rem;
        border-radius: 0.5rem;
        border: 1px solid #ccc;
        width: 100%;
        font-family: inherit;
      }

      .form-input:focus,
      select:focus,
      .form-textarea:focus {
        outline: none;
        border-color: var(--color-primary);
        box-shadow: 0 0 0 3px rgba(0, 166, 147, 0.2);
      }

      .form-label {
        display: block;
        font-weight: 600;
        margin-bottom: 0.25rem;
        font-size: 0.875rem;
        color: var(--color-text-dark);
      }

      /* Buttons (Matching Image Style) */
      .primary-button {
        padding: 0.75rem 1.5rem;
        background-color: var(--color-primary);
        /* Use primary color */
        color: white;
        font-weight: 600;
        border-radius: 0.5rem;
        transition: background-color 0.2s;
        cursor: pointer;
      }

      .primary-button:hover {
        background-color: #008f7d;
      }

      /* Header */
      header {
        background-color: var(--color-text-light);
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        position: sticky;
        top: 0;
        width: 100%;
        z-index: 10;
        padding: 1rem 2rem;
      }

      /* Card Style (Matching Image) */
      .centered-card {
        background-color: white;
        border-radius: 1rem;
        padding: 2rem;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        max-width: 800px;
        width: 100%;
        margin: 2rem auto;
      }

      .main-title {
        color: #059669;
        /* Darker Green for Title */
        font-size: 1.875rem;
        font-weight: 700;
        margin-bottom: 1.5rem;
        text-align: center;
      }

      .section-title {
        color: var(--color-primary);
        font-size: 1.125rem;
        font-weight: 700;
      }

      /* RTL Fixes */
      .lang-ur .form-label {
        text-align: right;
      }

      .lang-ur .form-group {
        text-align: right;
      }

      .lang-ur .text-center {
        text-align: center;
      }

      .lang-ur .text-right {
        text-align: right;
      }
    </style>
  </head>

  <body class="lang-en">
    <script>
      // --- Dummy Data ---
      // Simulating detailed data for an old student
      const DUMMY_STUDENTS_DATA = {
        DAKH001: {
          name: "Ahmed Khan",
          parent: "Mr. Zafar Khan",
          mobile: "9997983085",
          oldClass: "Hifz 1",
          status: "Re-Admission Pending",
          district: "Delhi",
        },
        DAKH010: {
          name: "Rihana Saleem",
          parent: "Saleem Ahmed",
          mobile: "03491234567",
          oldClass: "5",
          status: "Readmission Approved",
          district: "Lahore",
        },
      };

      // --- Multilingual Data ---
      const langData = {
        en: {
          academic_system: "Academic System",
          page_title: "Admission Old Students",
          back_to_academic: "Back to Academic",
          logout: "Logout",

          // Form/Labels
          form_title: "Old Student Information",
          enter_admission_no: "Enter the admission number:",
          bring_details: "Bring details.",
          student_details: "Current Student Record",
          re_admission_data: "Re-Admission Data",
          old_class: "Previous Class:",
          re_admit_class: "Class for Re-Admission:",
          re_admit_fee: "Re-Admission Fee:",
          save_re_admission: "Save Re-Admission",
          district: "District:",
          mobile: "Mobile:",

          // Messages
          student_found: "Student record found. Please verify and proceed.",
          student_not_found: "Error: Admission number not found.",
          re_admission_success: "Re-Admission processed successfully!",
          name: "Name",
          parent: "Parent",
          status: "Status",
        },
        hi: {
          academic_system: "शैक्षणिक प्रणाली",
          page_title: "पुराने छात्र का प्रवेश",
          back_to_academic: "शैक्षणिक पर वापस",
          logout: "लॉगआउट",

          // Form/Labels
          form_title: "पुराने छात्र की जानकारी",
          enter_admission_no: "प्रवेश संख्या दर्ज करें:",
          bring_details: "विवरण प्राप्त करें।",
          student_details: "वर्तमान छात्र रिकॉर्ड",
          re_admission_data: "पुनः प्रवेश डेटा",
          old_class: "पिछली कक्षा:",
          re_admit_class: "पुनः प्रवेश के लिए कक्षा:",
          re_admit_fee: "पुनः प्रवेश शुल्क:",
          save_re_admission: "पुनः प्रवेश सहेजें",
          district: "जिला:",
          mobile: "मोबाइल:",

          // Messages
          student_found:
            "छात्र रिकॉर्ड मिल गया। कृपया सत्यापित करें और आगे बढ़ें।",
          student_not_found: "त्रुटि: प्रवेश संख्या नहीं मिली।",
          re_admission_success: "पुनः प्रवेश सफलतापूर्वक संसाधित किया गया!",
          name: "नाम",
          parent: "अभिभावक",
          status: "स्थिति",
        },
        ur: {
          academic_system: "تعلیمی نظام",
          page_title: "داخلہ قدیم طلباء",
          back_to_academic: "اکیڈمک پر واپس جائیں",
          logout: "لاگ آؤٹ",

          // Form/Labels
          form_title: "قدیم طالب علم کی معلومات",
          enter_admission_no: "داخلہ نمبر درج کریں:",
          bring_details: "تفصیلات لائیں۔",
          student_details: "موجودہ طالب علم کا ریکارڈ",
          re_admission_data: "دوبارہ داخلہ ڈیٹا",
          old_class: "پچھلی کلاس:",
          re_admit_class: "دوبارہ داخلہ کے لیے کلاس:",
          re_admit_fee: "دوبارہ داخلہ فیس:",
          save_re_admission: "دوبارہ داخلہ محفوظ کریں",
          district: "ضلع:",
          mobile: "موبائل:",

          // Messages
          student_found:
            "طالب علم کا ریکارڈ مل گیا۔ براہ کرم تصدیق کریں اور آگے بڑھیں۔",
          student_not_found: "خرابی: داخلہ نمبر نہیں ملا۔",
          re_admission_success: "دوبارہ داخلہ کامیابی سے پروسیس ہوا!",
          name: "نام",
          parent: "سرپرست",
          status: "حالت",
        },
      };

      let currentLang = "en";

      function getTranslation(key) {
        return langData[currentLang][key] || langData["en"][key] || key;
      }

      // --- Core UI Update Functions ---
      function updateContent() {
        document.body.className = "lang-" + currentLang;
        const isRtl = currentLang === "ur";

        document.querySelectorAll("[data-lang-key]").forEach((el) => {
          const key = el.getAttribute("data-lang-key");
          el.textContent = getTranslation(key);
        });

        // Apply RTL alignment to form groups
        document.querySelectorAll(".form-group").forEach((group) => {
          group.style.textAlign = isRtl ? "right" : "left";
        });
        document.querySelectorAll(".form-input, select").forEach((input) => {
          input.style.direction = isRtl ? "rtl" : "ltr";
        });
      }

      function changeLanguage(lang) {
        if (lang in langData) {
          currentLang = lang;
          localStorage.setItem("madarsaSystemLang", lang);
          updateContent();
        }
      }

      // --- Form Look-up Logic ---
      function lookupStudent(event) {
        event.preventDefault();
        const admissionNo = document
          .getElementById("admission-number")
          .value.toUpperCase()
          .trim();
        const student = DUMMY_STUDENTS_DATA[admissionNo];
        const detailsArea = document.getElementById("student-details-area");

        detailsArea.innerHTML = ""; // Clear previous results

        if (student) {
          detailsArea.classList.remove("hidden");
          detailsArea.innerHTML = createReAdmissionForm(student, admissionNo);
          alert(getTranslation("student_found"));
        } else {
          detailsArea.classList.add("hidden");
          alert(getTranslation("student_not_found"));
        }

        updateContent(); // Reapply translations to new content
        return false;
      }

      function createReAdmissionForm(student, admissionNo) {
        const isRtl = currentLang === "ur";
        const alignment = isRtl ? "text-right" : "text-left";

        return `
                <div class="${alignment} space-y-6">
                    <h3 class="section-title border-b pb-2" data-lang-key="student_details">${getTranslation(
                      "student_details"
                    )}</h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-x-6 gap-y-4 text-sm">
                        
                        <div class="info-group">
                            <label class="form-label text-gray-500">${getTranslation(
                              "name"
                            )}</label>
                            <p class="font-semibold text-gray-800">${
                              student.name
                            }</p>
                        </div>
                        <div class="info-group">
                            <label class="form-label text-gray-500">${getTranslation(
                              "parent"
                            )}</label>
                            <p class="font-semibold text-gray-800">${
                              student.parent
                            }</p>
                        </div>
                        <div class="info-group">
                            <label class="form-label text-gray-500" data-lang-key="mobile">${getTranslation(
                              "mobile"
                            )}</label>
                            <p class="font-semibold text-gray-800">${
                              student.mobile
                            }</p>
                        </div>

                        <div class="info-group">
                            <label class="form-label text-gray-500" data-lang-key="district">${getTranslation(
                              "district"
                            )}</label>
                            <p class="font-semibold text-gray-800">${
                              student.district
                            }</p>
                        </div>
                        <div class="info-group">
                            <label class="form-label text-gray-500" data-lang-key="old_class">${getTranslation(
                              "old_class"
                            )}</label>
                            <p class="font-semibold text-gray-800">${
                              student.oldClass
                            }</p>
                        </div>
                        <div class="info-group">
                            <label class="form-label text-gray-500" data-lang-key="status">${getTranslation(
                              "status"
                            )}</label>
                            <p class="font-semibold text-red-600">${
                              student.status
                            }</p>
                        </div>
                    </div>
                    
                    <h3 class="section-title border-b pb-2 pt-4" data-lang-key="re_admission_data">${getTranslation(
                      "re_admission_data"
                    )}</h3>
                    
                    <form onsubmit="return saveReAdmission(event, '${admissionNo}')">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                            <div class="form-group">
                                <label for="new-class" class="form-label" data-lang-key="re_admit_class">${getTranslation(
                                  "re_admit_class"
                                )}</label>
                                <select id="new-class" class="form-input" required>
                                    <option value="" disabled selected>-- Select New Class --</option>
                                    <option value="Hifz 2">Hifz 2</option>
                                    <option value="6">6</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="re-admission-fee" class="form-label" data-lang-key="re_admit_fee">${getTranslation(
                                  "re_admit_fee"
                                )}</label>
                                <input type="number" id="re-admission-fee" class="form-input" value="1500.00" min="0" step="0.01" required>
                            </div>
                        </div>
                        
                        <div class="flex justify-center mt-8">
                            <button type="submit" class="primary-button" data-lang-key="save_re_admission">${getTranslation(
                              "save_re_admission"
                            )}</button>
                        </div>
                    </form>
                </div>
            `;
      }

      function saveReAdmission(event, admissionNo) {
        event.preventDefault();
        const form = event.target;

        const newClass = form.querySelector("#new-class").value;
        const fee = parseFloat(form.querySelector("#re-admission-fee").value);

        if (!newClass || isNaN(fee)) {
          alert("Please select a class and enter the fee.");
          return false;
        }

        console.log(
          `Re-admitting student ${admissionNo} to Class ${newClass} with fee ${fee}`
        );
        alert(getTranslation("re_admission_success"));

        // Reset lookup form and hide details area
        document.getElementById("lookup-form").reset();
        document.getElementById("student-details-area").classList.add("hidden");

        return false;
      }

      function logOut() {
        localStorage.removeItem("isUserLoggedIn");
        localStorage.removeItem("authToken");
        localStorage.removeItem("userData");
        window.location.href = "index.html";
      }

      // Initialize content and language
      window.onload = function () {
        const storedLang = localStorage.getItem("madarsaSystemLang");
        currentLang = storedLang && storedLang in langData ? storedLang : "en";

        // Initial content update
        updateContent();

        // Attach listener to lookup form
        document
          .getElementById("lookup-form")
          .addEventListener("submit", lookupStudent);
      };
    </script>

    <!-- HEADER -->
    <header>
      <div class="max-w-7xl mx-auto w-full flex justify-between items-center">
        <!-- Left: Back Button & Title -->
        <div class="flex items-center space-x-4">
          <a
            href="academic_system.html"
            class="action-button bg-gray-100 text-gray-700 hover:bg-gray-200"
            data-lang-key="back_to_academic"
            >Back to Academic</a
          >
          <h1
            class="text-xl font-bold"
            data-lang-key="page_title"
            style="color: var(--color-primary)"
          >
            Old Student Admission
          </h1>
        </div>

        <!-- Right: Language Switch (Simplified) -->
        <div class="flex items-center space-x-2">
          <select
            onchange="changeLanguage(this.value)"
            class="bg-gray-100 rounded-lg p-1 text-sm"
          >
            <option value="en" selected>English</option>
            <option value="hi">हिन्दी</option>
            <option value="ur">اردو</option>
          </select>
          <button
            onclick="logOut()"
            class="text-sm font-semibold text-red-600 hover:text-red-800 transition-colors ml-4 action-button px-3 py-1"
          >
            Logout
          </button>
        </div>
      </div>
    </header>

    <!-- MAIN CONTENT AREA -->
    <main class="w-full p-4 md:p-8">
      <!-- Look-up Card -->
      <div class="centered-card">
        <h2 class="main-title" data-lang-key="form_title">
          Old Student Information
        </h2>

        <!-- Lookup Form -->
        <form id="lookup-form" class="space-y-6">
          <div class="form-group text-center">
            <label
              for="admission-number"
              class="form-label text-base"
              data-lang-key="enter_admission_no"
              >Enter the admission number:</label
            >
            <input
              type="text"
              id="admission-number"
              class="form-input text-center max-w-sm mx-auto mt-2"
              placeholder="DAKH001"
              required
            />
          </div>

          <div class="flex justify-center pt-4">
            <button
              type="submit"
              class="primary-button"
              data-lang-key="bring_details"
            >
              Bring details.
            </button>
          </div>
        </form>
      </div>

      <!-- Details and Re-Admission Form (Dynamic Area) -->
      <div id="student-details-area" class="centered-card mt-8 hidden">
        <!-- Dynamic Re-Admission form will be injected here upon successful lookup -->
      </div>
    </main>
  </body>
</html>
